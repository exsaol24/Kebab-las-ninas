{# templates/inicio/index.html.twig #}
{% extends 'base.html.twig' %}

{% set page_css = 'inicio' %}

{% block title %}Inicio - Kebab Las Niñas{% endblock %}

{% block body %}




    <section class="banner">
        <div class="banner-content">
            <h2>¡El mejor sabor en cada bocado!</h2>
            <p>Disfruta de nuestros kebabs únicos y deliciosos.</p>
            <a href="#about" class="btn btn-primary">Conócenos</a>
        </div>
        <div class="banner-image">
            <img src="{{ asset('img/prueba1.png') }}" alt="Deliciosos Kebabs">
        </div>
    </section>

    <section id="about" class="about-us">
        <h2>Sobre Nosotros</h2>
        <p>En Kebab Las Niñas nos especializamos en ofrecer comida rápida de calidad, con un toque único que encanta a nuestros clientes.</p>
        <div class="about-image">
            <img src="{{ asset('img/prueba3.png') }}" alt="Sobre Nosotros">
        </div>
    </section>

    <section id="testimonials" class="testimonials">
        <h2>Lo que dicen nuestros clientes</h2>
        <div class="testimonials-grid">
            <div class="testimonial-card">
                <p>"¡El mejor kebab que he probado! Definitivamente volveré."</p>
                <span>- Juan Pérez</span>
            </div>
            <div class="testimonial-card">
                <p>"Excelente servicio y comida deliciosa. Muy recomendado."</p>
                <span>- María López</span>
            </div>
            <div class="testimonial-card">
                <p>"Un lugar perfecto para disfrutar con amigos y familia."</p>
                <span>- Carlos García</span>
            </div>
        </div>
    </section>

    <section id="platos" class="platos">
        <h2>Nuestros Platos</h2>
        <div class="platos-grid">
            {% for plato in platos %}
                <div class="plato-card">
                    <img src="{{ asset(plato.imagen) }}" alt="{{ plato.nombre }}" class="plato-imagen">
                    <div class="plato-info">
                        <h3 class="plato-nombre">{{ plato.nombre }}</h3>
                        <p class="plato-descripcion">{{ plato.descripcion }}</p>
                        <p class="plato-precio">{{ plato.precio | number_format(2, '.', ',') }} €</p>

                        {% if app.session.get('user_name') is not null %}
                            <a href="{{ path('app_carrito_agregar', {'id': plato.id}) }}"
                               class="btn btn-add-to-cart js-add-to-cart"
                               data-plato-id="{{ plato.id }}">
                                Añadir al carrito
                            </a>
                        {% else %}
                            <span class="btn btn-add-to-cart js-login-required"
                                data-login-message="Debes iniciar sesión para añadir productos al carrito.">
                                Añadir al carrito
                            </span>
                        {% endif %}

                    </div>
                </div>
            {% else %}
                <p>No hay platos disponibles en este momento.</p>
            {% endfor %}
        </div>
    </section>

    <footer id="contact" class="footer">
        <p>© 2025 Kebab Las Niñas. Todos los derechos reservados.</p>
        <p>Contacto: <a href="mailto:info@kebablasniñas.com">info@kebablasniñas.com</a></p>
        <p>Síguenos en nuestras redes sociales:</p>
        <div class="social-links">
            <a href="#"><img src="{{ asset('img/facebook.png') }}" alt="Facebook"></a>
            <a href="#"><img src="{{ asset('img/instagram.png') }}" alt="Instagram"></a>
            <a href="#"><img src="{{ asset('img/x.png') }}" alt="Twitter"></a>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Manejo para usuarios no logueados
            const loginRequiredButtons = document.querySelectorAll('.js-login-required');
            loginRequiredButtons.forEach(button => {
                button.addEventListener('click', function (event) {
                    event.preventDefault();
                    const message = this.dataset.loginMessage || 'Debes iniciar sesión.';
                    alert(message);
                });
            });

            // AJAX para añadir al carrito
            const addToCartButtons = document.querySelectorAll('.js-add-to-cart');
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function (event) {
                    event.preventDefault();
                    const platoId = this.dataset.platoId;
                    fetch('{{ path('app_carrito_agregar', {'id': 'PLATO_ID'}) }}'.replace('PLATO_ID', platoId), {
                        method: 'POST',
                        headers: {
                            'X-Requested-With': 'XMLHttpRequest',
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('Plato añadido al carrito.');
                            // Actualizar contador carrito en navbar
                            let cartCount = document.querySelector('.cart-count');
                            if (!cartCount) {
                                // Buscar el enlace del carrito
                                const cartLink = document.querySelector('.cart-icon-link');
                                if (cartLink) {
                                    cartCount = document.createElement('span');
                                    cartCount.className = 'cart-count';
                                    cartLink.appendChild(cartCount);
                                }
                            }
                            if (cartCount) {
                                cartCount.textContent = data.total_productos_carrito;
                                cartCount.style.display = data.total_productos_carrito > 0 ? 'inline-block' : 'none';
                            }
                        } else {
                            alert(data.message || 'Error al añadir al carrito.');
                        }
                    })
                    .catch(() => {
                        alert('Error de red al añadir al carrito.');
                    });
                });
            });
        });
    </script>

{% endblock %}